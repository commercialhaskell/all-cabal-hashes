cabal-version:       2.2

name:                newsletter
version:             0
synopsis:            A basic newsletter implimentation, using various backends.
description:
  This package impliments a webserver that manages mailing list subscripts and provides
  tools to send to said list. Mail sending services are provided by backends like
  <newsletter-mailgun https://hackage.haskell.org/package/newsletter-mailgun>.
homepage:            https://oss.xkcd.com/
license:             BSD-3-Clause
license-file:        LICENSE
author:              davean
maintainer:          oss@xkcd.com
copyright:           Copyright (C) 2019 davean
category:            Email, Web
extra-source-files:  CHANGELOG.md

source-repository head
  type: git
  location: https://code.xkrd.net/haskell/newsletter.git

common deps
  build-depends:
      aeson                ^>= 1.4
    , base                 ^>= 4.12.0.0
    , blaze-html           ^>= 0.9
    , bytestring           ^>= 0.10
    , clientsession        ^>= 0.9
    , email-validate       ^>= 2.3
    , http-api-data        ^>= 0.4
    , lens                 ^>= 4.17
    , machines             ^>= 0.6
    , mime-mail            ^>= 0.5
    , mtl                  ^>= 2.2
    , network-uri          ^>= 2.6
    , psqueues             ^>= 0.2
    , random               ^>= 1.1
    , servant              ^>= 0.15
    , servant-blaze        ^>= 0.9
    , servant-server       ^>= 0.15
    , stm                  ^>= 2.5
    , text                 ^>= 1.2
    , time                 ^>= 1.8
    , unordered-containers ^>= 0.2

library
  import: deps
  hs-source-dirs:      src
  default-language:    Haskell2010
  exposed-modules:
    Network.Mail.Newsletter
    Network.Mail.Newsletter.Class
    Network.Mail.Newsletter.Web
    Network.Mail.Newsletter.Web.API
    Network.Mail.Newsletter.Web.Dedup.InMem
    Network.Mail.Newsletter.Web.Handlers
    Network.Mail.Newsletter.Web.Templates

executable newsletter-server
  import:              deps
  main-is:             Server.hs
  hs-source-dirs:      tools
  default-language:    Haskell2010
  build-depends:
    , newsletter
    , warp       ^>= 3.2
