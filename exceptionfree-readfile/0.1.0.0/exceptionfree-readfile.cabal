-- This file exists because cabal doesn't deal well with flags when running dist (via. `stack sdist`)
-- This file *should* be equivalent to the regular build without the oxidized version

cabal-version: 1.12

name:           exceptionfree-readfile
version:        0.1.0.0
description:    Please see the README on Gitlab at <https://gitlab.com/mrman/haskell-exceptionfree-readfile#readme>
homepage:       https://gitlab.com/mrman/haskell-exceptionfree-readfile#readme
bug-reports:    https://gitlab.com/mrman/haskell-exceptionfree-readfile/issues
category:       Utility
synopsis:       An exception-free readFile for use with '+RTS -xc -RTS' projects
author:         vados
maintainer:     vados@vadosware.io
copyright:      2019 vados
license:        BSD3
license-file:   LICENSE
build-type:     Simple
extra-source-files:
    README.md
    ChangeLog.md

source-repository head
  type: git
  location: https://gitlab.com/mrman/haskell-exceptionfree-readfile

library
  exposed-modules:
      System.IO.ExceptionFree
      System.IO.ExceptionFree.Internal.Custom
  other-modules:
      Paths_exceptionfree_readfile
  hs-source-dirs:
      src
  build-depends:
      base >=4.7 && <5
  default-language: Haskell2010

test-suite unit
  type: exitcode-stdio-1.0
  hs-source-dirs: test/unit/custom
  main-is: Spec.hs

  other-modules:
      Paths_exceptionfree_readfile
    , CustomUnitSpec
    , Util
    , Fixtures
  hs-source-dirs:
      test
  ghc-options: -threaded -rtsopts -with-rtsopts=-N
  build-depends:
      base >=4.7 && <5
    , exceptionfree-readfile
    , hspec
    , temporary
  default-language: Haskell2010

test-suite e2e
  type: exitcode-stdio-1.0

  hs-source-dirs: test/e2e/custom

  main-is: Spec.hs

  other-modules:
      Paths_exceptionfree_readfile
    , CustomBinarySpec
    , Util
    , Fixtures
  hs-source-dirs:
      test
  ghc-options: -threaded -rtsopts -with-rtsopts=-N
  build-depends:
      base >=4.7 && <5
    , exceptionfree-readfile
    , hspec
    , process
    , temporary
  default-language: Haskell2010

benchmark bench
  main-is: Bench.hs
  type: exitcode-stdio-1.0
  hs-source-dirs: bench
  other-modules:
      Paths_exceptionfree_readfile
  ghc-options: -threaded -rtsopts -with-rtsopts=-N
  build-depends:
      base >=4.7 && <5
    , exceptionfree-readfile
    , deepseq
    , criterion
  default-language: Haskell2010
