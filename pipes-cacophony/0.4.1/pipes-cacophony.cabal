name:          pipes-cacophony
version:       0.4.1
synopsis:      Pipes for Noise-secured network connections.
license:       PublicDomain
license-file:  LICENSE
author:        John Galt
maintainer:    jgalt@centromere.net
homepage:      https://github.com/centromere/pipes-cacophony
bug-reports:   https://github.com/centromere/pipes-cacophony/issues
category:      Pipes, Cryptography
build-type:    Simple
cabal-version: >=1.10
tested-with:   GHC == 7.10.3, GHC == 8.0.2
description:
  A set of pipes to secure network connections with the
  <https://github.com/trevp/noise/blob/master/noise.md Noise> protocol.

extra-source-files:
  .travis.yml
  README.md
  changelog.md
  LICENSE
  tests/.hlint

source-repository head
  type: git
  location: https://github.com/centromere/pipes-cacophony.git

--------------------------------------------------------------------------------
-- FLAGS

flag hlint
  description: Build hlint test

flag build-examples
  description: Build example executables
  default: False
  manual: True

flag llvm
  default: False
  manual: True

--------------------------------------------------------------------------------
-- LIBRARY

library
  build-depends:
    base        >=4.8 && <5,
    bytestring,
    cacophony   >=0.9,
    memory,
    pipes
  hs-source-dirs:   src
  default-language: Haskell2010
  exposed-modules:
    Pipes.Noise
  ghc-options:      -Wall -fwarn-tabs

  if flag(llvm)
    ghc-options: -fllvm

--------------------------------------------------------------------------------
-- EXAMPLES

executable loopback
  default-language: Haskell2010
  hs-source-dirs:   examples/loopback
  main-is:          Main.hs

  if flag(build-examples)
    build-depends:
      base            >=4.8 && <5,
      bytestring,
      cacophony       >=0.9,
      lens,
      memory,
      pipes,
      pipes-cacophony
  else
    buildable: False

  ghc-options:      -threaded -O2 -rtsopts -with-rtsopts=-N -Wall -fwarn-tabs

  if flag(llvm)
    ghc-options: -fllvm

--------------------------------------------------------------------------------
-- TESTS

test-suite hlint
  type:             exitcode-stdio-1.0
  main-is:          hlint.hs
  ghc-options:      -Wall -fwarn-tabs
  hs-source-dirs:   tests
  default-language: Haskell2010

  if !flag(hlint)
    buildable: False
  else
    build-depends:
      base  >=4.8 && <5,
      hlint

  if flag(llvm)
    ghc-options: -fllvm
