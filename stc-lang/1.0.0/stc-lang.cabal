cabal-version: 1.12
name: stc-lang
version: 1.0.0
x-revision: 1
license: BSD3
license-file: LICENSE
copyright: 2017-2019 Norman Rink, Sebastian Ertel, Justus Adam
maintainer: justus.adam@tu-dresden.de
author: Norman Rink, Sebastian Ertel, Justus Adam
homepage: https://github.com/ohua-dev/stc-lang#readme
synopsis: A library for implicit, monadic dataflow parallelism
description:
    See the <https://github.com/ohua-dev/stc-lang#readme readme>
category: Concurrency, Development
build-type: Simple
extra-source-files:
    README.md

source-repository head
    type: git
    location: https://github.com/ohua-dev/stc-lang

flag debug-sched
    description:
        Enable the debuggable scheduler
    default: False
    manual: True

library
    exposed-modules:
        Control.Monad.SD
        Data.Dynamic2
        Data.StateElement
        Type.Magic
        Control.Monad.Generator
        Control.Monad.Stream
        Control.Monad.Stream.Chan
        Control.Monad.Stream.Par
        Control.Monad.Stream.PinnedChan
    hs-source-dirs: src
    other-modules:
        Control.Monad.SD.Case
        Control.Monad.SD.Combinator
        Control.Monad.SD.FRP
        Control.Monad.SD.Ohua
        Control.Monad.SD.STCLang
        Control.Monad.SD.Smap
    default-language: Haskell2010
    default-extensions: DeriveGeneric ExistentialQuantification
                        ExplicitForAll FlexibleContexts FlexibleInstances
                        ScopedTypeVariables TupleSections LambdaCase RankNTypes
                        NamedFieldPuns MultiParamTypeClasses RecordWildCards
                        TypeSynonymInstances BangPatterns DeriveFunctor RecordWildCards
    ghc-options: -Wall -O2 -fPIC -fno-cse
    build-depends:
        BoundedChan >=1.0.3.0,
        abstract-par >=0.3.3,
        base >=4.7 && <5,
        bytestring >=0.10.8.2,
        deepseq >=1.4.3.0,
        microlens >=0.4.8.3,
        monad-par >=0.3.4.8,
        monad-par-extras >=0.3.3,
        mtl >=2.2.1,
        transformers >=0.5.2.0
    
    if flag(debug-sched)
        cpp-options: -DDEBUG_SCHED
    
    if impl(ghc >=8.0.0)
        other-modules:
            Type.Magic.GHC8
    else
        other-modules:
            Type.Magic.OldGHC

executable ohua-stream-bench
    main-is: algo.hs
    hs-source-dirs: stream-bench
    other-modules:
        CampaignProcMap
        MutableNFMap
        MutableSet
        Paths_stc_lang
    default-language: Haskell2010
    default-extensions: DeriveGeneric ExistentialQuantification
                        ExplicitForAll FlexibleContexts FlexibleInstances
                        ScopedTypeVariables TupleSections LambdaCase RankNTypes
                        NamedFieldPuns MultiParamTypeClasses RecordWildCards
                        TypeSynonymInstances BangPatterns DeriveFunctor RecordWildCards
    ghc-options: -Wall -O2 -threaded -with-rtsopts=-N
    build-depends:
        BoundedChan >=1.0.3.0,
        aeson >=1.2.3.0,
        base >=4.7 && <5,
        bytestring >=0.10.8.2,
        clock >=0.7.2,
        deepseq >=1.4.3.0,
        hashable >=1.2.6.1,
        hashtables >=1.2.2.1,
        hedis >=0.9.12,
        hw-kafka-client >=2.6.0,
        microlens >=0.4.8.3,
        microlens-aeson >=2.2.0.2,
        mtl >=2.2.1,
        random >=1.1,
        stc-lang -any,
        text >=1.2.2.2,
        transformers >=0.5.2.0,
        uuid-types >=1.0.3,
        vector >=0.12.0.1,
        yaml >=0.8.28

test-suite statefulness-test
    type: exitcode-stdio-1.0
    main-is: Spec.hs
    hs-source-dirs: test
    other-modules:
        FakeComputation
        SD.Correctness
        SD.Performance
        Paths_stc_lang
    default-language: Haskell2010
    default-extensions: DeriveGeneric ExistentialQuantification
                        ExplicitForAll FlexibleContexts FlexibleInstances
                        ScopedTypeVariables TupleSections LambdaCase RankNTypes
                        NamedFieldPuns MultiParamTypeClasses RecordWildCards
                        TypeSynonymInstances BangPatterns DeriveFunctor RecordWildCards
    ghc-options: -Wall -O2 -threaded -rtsopts -with-rtsopts=-N4
    build-depends:
        HUnit >=1.6.0.0,
        base >=4.7 && <5,
        deepseq >=1.4.3.0,
        ghc-prim >=0.5.1.1,
        microlens >=0.4.8.3,
        mtl >=2.2.1,
        stc-lang -any,
        test-framework >=0.8.1.1,
        test-framework-hunit >=0.3.0.2,
        time >=1.8.0.2,
        transformers >=0.5.2.0
