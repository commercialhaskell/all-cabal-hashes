cabal-version:      2.0
name:               polysemy-plugin
version:            0.2.5.2
license:            BSD3
license-file:       LICENSE
copyright:          2019 Sandy Maguire
maintainer:         sandy@sandymaguire.me
author:             Sandy Maguire
homepage:           https://github.com/isovector/polysemy#readme
bug-reports:        https://github.com/isovector/polysemy/issues
synopsis:           Disambiguate obvious uses of effects.
description:
    Please see the README on GitHub at <https://github.com/isovector/polysemy/tree/master/polysemy-plugin#readme>

category:           Polysemy
build-type:         Custom
extra-source-files:
    README.md
    ChangeLog.md

source-repository head
    type:     git
    location: https://github.com/isovector/polysemy

custom-setup
    setup-depends:
        Cabal >=3.0.1.0 && <3.1,
        base >=4.9 && <5,
        cabal-doctest >=1.0.6 && <1.1

flag corelint
    description: Perform the corelint tests
    default:     False
    manual:      True

library
    exposed-modules:
        Polysemy.Plugin
        Polysemy.Plugin.Fundep
        Polysemy.Plugin.Fundep.Stuff
        Polysemy.Plugin.Fundep.Unification
        Polysemy.Plugin.Fundep.Utils

    hs-source-dirs:     src
    other-modules:      Paths_polysemy_plugin
    autogen-modules:    Paths_polysemy_plugin
    default-language:   Haskell2010
    default-extensions:
        DataKinds DeriveFunctor FlexibleContexts GADTs LambdaCase PolyKinds
        RankNTypes ScopedTypeVariables StandaloneDeriving TypeApplications
        TypeOperators TypeFamilies UnicodeSyntax

    build-depends:
        base >=4.9 && <5,
        containers >=0.5 && <0.7,
        ghc >=8.4.4 && <9,
        ghc-tcplugins-extra >=0.3 && <0.5,
        polysemy >=1.3 && <1.5,
        syb ==0.7.*,
        transformers >=0.5.2.0 && <0.6

test-suite polysemy-plugin-test
    type:               exitcode-stdio-1.0
    main-is:            Main.hs
    build-tool-depends: hspec-discover:hspec-discover -any
    hs-source-dirs:     test
    other-modules:
        BadSpec
        DoctestSpec
        ExampleSpec
        LegitimateTypeErrorSpec
        MultipleVarsSpec
        PluginSpec
        TypeErrors
        VDQSpec
        Paths_polysemy_plugin
        Build_doctests

    autogen-modules:    Build_doctests
    default-language:   Haskell2010
    default-extensions:
        DataKinds DeriveFunctor FlexibleContexts GADTs LambdaCase PolyKinds
        RankNTypes ScopedTypeVariables StandaloneDeriving TypeApplications
        TypeOperators TypeFamilies UnicodeSyntax

    ghc-options:
        -threaded -rtsopts -with-rtsopts=-N -fplugin=Polysemy.Plugin

    build-depends:
        base >=4.9 && <5,
        containers >=0.5 && <0.7,
        doctest >=0.16.0.1 && <0.17,
        ghc >=8.4.4 && <9,
        ghc-tcplugins-extra >=0.3 && <0.5,
        hspec >=2.6.0 && <3,
        inspection-testing >=0.4.2 && <0.5,
        polysemy >=1.3.0.0 && <1.5,
        polysemy-plugin -any,
        should-not-typecheck >=2.1.0 && <3,
        syb ==0.7.*,
        transformers >=0.5.2.0 && <0.6

    if flag(corelint)
        ghc-options: -dcore-lint -dsuppress-all
