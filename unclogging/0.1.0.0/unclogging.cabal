cabal-version:   3.4
name:            unclogging
version:         0.1.0.0
synopsis:
  a library which implements easy, concurrent and pretty logging

description:
  Simple, yet extensible concurrent logging system based on publish/subscribe. The library is supposed to be easy to use, concurrent and pretty. It is practical for small applications like web-servers or command line programs.

license:         AGPL-3.0-or-later
license-file:    LICENSE
author:          mangoiv
maintainer:      contact@mangoiv.com
category:        Concurrency
build-type:      Simple
extra-doc-files:
  CHANGELOG.md
  README.md

source-repository head
  type:     git 
  location: git://git.mangoiv.com/mangoiv/unclogging.git

common common-all
  ghc-options:        -Wall

  if impl(ghc >=9.6.1)
    ghc-options: -fno-show-error-context

  default-extensions:
    BlockArguments
    DerivingStrategies
    DerivingVia
    GADTs
    ImportQualifiedPost
    LambdaCase
    OverloadedRecordDot
    OverloadedStrings

library
  import:           common-all
  exposed-modules:
    Control.Carrier.Unclog
    Control.Effect.Unclog
    Control.Effect.Unclog.Json
    Control.Effect.Unclog.Text
    Unclog
    Unclog.Common
    Unclog.Frontend
    Unclog.IO.Json
    Unclog.IO.Text
    Unclog.Render
    Unclog.Subscriber

  build-depends:
    , aeson             <2.3
    , async             <2.3
    , base              <5
    , bytestring        <0.13
    , chronos           <1.2
    , colourista        <0.2
    , fused-effects     <1.2
    , kan-extensions    <6
    , template-haskell  <2.23
    , text              <2.2
    , unliftio          <0.3

  hs-source-dirs:   src
  default-language: GHC2021

executable unclogging
  import:           common-all
  main-is:          Main.hs
  build-depends:
    , aeson
    , async
    , base
    , unclogging
    , unliftio

  hs-source-dirs:   app
  default-language: GHC2021
  ghc-options:      -threaded -rtsopts -with-rtsopts=-N

test-suite unclogging-test
  import:           common-all
  default-language: GHC2021
  type:             exitcode-stdio-1.0
  hs-source-dirs:   test
  main-is:          Main.hs
  ghc-options:      -threaded -rtsopts -with-rtsopts=-N
  other-modules:    Test.Unclogging
  build-depends:
    , aeson
    , base
    , fused-effects
    , tasty
    , tasty-hunit
    , unclogging
    , unliftio
