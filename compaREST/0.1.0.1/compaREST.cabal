cabal-version:      2.4
name:               compaREST
version:            0.1.0.1
license:            MIT
license-file:       LICENSE
copyright:          2021 Typeable
maintainer:         compaREST@typeable.io
author:             Typeable
tested-with:        ghc ==8.10.4
synopsis:           Compatibility checker for OpenAPI
description:        Compatibility checker for OpenAPI.
category:           Web
build-type:         Simple
extra-source-files:
    awsm-css/dist/awsm.min.css
    test/golden/**/*.yaml
    test/golden/**/*.md

extra-doc-files:
    README.md
    CHANGELOG.md

library
    exposed-modules:
        Data.OpenApi.Compare.Behavior
        Data.OpenApi.Compare.Common
        Data.OpenApi.Compare.Formula
        Data.OpenApi.Compare.Memo
        Data.OpenApi.Compare.Orphans
        Data.OpenApi.Compare.Paths
        Data.OpenApi.Compare.PathsPrefixTree
        Data.OpenApi.Compare.References
        Data.OpenApi.Compare.Report
        Data.OpenApi.Compare.Report.Html.Template
        Data.OpenApi.Compare.Report.Jet
        Data.OpenApi.Compare.Run
        Data.OpenApi.Compare.Subtree
        Data.OpenApi.Compare.Validate.Header
        Data.OpenApi.Compare.Validate.Link
        Data.OpenApi.Compare.Validate.MediaTypeObject
        Data.OpenApi.Compare.Validate.OAuth2Flows
        Data.OpenApi.Compare.Validate.OpenApi
        Data.OpenApi.Compare.Validate.Operation
        Data.OpenApi.Compare.Validate.Param
        Data.OpenApi.Compare.Validate.PathFragment
        Data.OpenApi.Compare.Validate.Products
        Data.OpenApi.Compare.Validate.RequestBody
        Data.OpenApi.Compare.Validate.Responses
        Data.OpenApi.Compare.Validate.Schema
        Data.OpenApi.Compare.Validate.Schema.DNF
        Data.OpenApi.Compare.Validate.Schema.Issues
        Data.OpenApi.Compare.Validate.Schema.JsonFormula
        Data.OpenApi.Compare.Validate.Schema.Partition
        Data.OpenApi.Compare.Validate.Schema.Process
        Data.OpenApi.Compare.Validate.Schema.Traced
        Data.OpenApi.Compare.Validate.Schema.TypedJson
        Data.OpenApi.Compare.Validate.SecurityRequirement
        Data.OpenApi.Compare.Validate.SecurityScheme
        Data.OpenApi.Compare.Validate.Server
        Data.OpenApi.Compare.Validate.Sums

    hs-source-dirs:     src
    other-modules:
        Data.HList
        Data.OpenUnion.Extra

    default-language:   Haskell2010
    default-extensions:
        ApplicativeDo BangPatterns ConstraintKinds DataKinds DeriveAnyClass
        DeriveFoldable DeriveFunctor DeriveGeneric DeriveTraversable
        DerivingStrategies DerivingVia DuplicateRecordFields
        EmptyDataDeriving FlexibleContexts FlexibleInstances
        FunctionalDependencies GADTs GeneralizedNewtypeDeriving LambdaCase
        MultiParamTypeClasses MultiWayIf NamedFieldPuns NumDecimals
        OverloadedStrings PatternSynonyms PolyKinds QuasiQuotes RankNTypes
        RecordWildCards ScopedTypeVariables StandaloneDeriving
        TemplateHaskell TupleSections TypeApplications TypeFamilies
        TypeOperators UndecidableInstances ViewPatterns
        QuantifiedConstraints DefaultSignatures

    ghc-options:
        -Weverything -Wno-implicit-prelude -Wno-missing-safe-haskell-mode
        -Wno-safe -Wno-prepositive-qualified-module
        -Wno-missing-import-lists -Wno-partial-fields
        -Wno-all-missed-specialisations -Wno-missing-local-signatures
        -Wno-unsafe -fconstraint-solver-iterations=0

    build-depends:
        base >=4.12.0.0 && <4.16,
        text >=1.2.4.1 && <1.3,
        pcre2 >=1.1.5 && <1.2,
        open-union >=0.4.0.0 && <0.5,
        vector >=0.12.3.1 && <0.13,
        unordered-containers >=0.2.16.0 && <0.3,
        type-fun >=0.1.3 && <0.2,
        typerep-map >=0.3.3.0 && <0.4,
        tagged >=0.8.6.1 && <0.9,
        scientific >=0.3.7.0 && <0.4,
        pandoc-types >=1.22.1 && <1.23,
        openapi3 >=3.1.0 && <3.2,
        lattices >=2.0.2 && <2.1,
        insert-ordered-containers >=0.2.5.1 && <0.3,
        http-media >=0.8.0.0 && <0.9,
        hashable >=1.3.0.0 && <1.4,
        free >=5.1.7 && <5.2,
        containers >=0.6.5.1 && <0.7,
        comonad >=5.0.8 && <5.1,
        attoparsec >=0.13.2.5 && <0.14,
        transformers >=0.5.6.2 && <0.6,
        mtl >=2.2.2 && <2.3,
        aeson >=1.5.6.0 && <1.6,
        generic-data >=0.9.2.1 && <0.10,
        doctemplates ==0.9.*,
        file-embed >=0.0.15.0 && <0.1,
        data-default >=0.7.1.1 && <0.8,
        ordered-containers >=0.2.2 && <0.3,
        bytestring >=0.10.12.0 && <0.11

executable compaREST
    main-is:            Main.hs
    hs-source-dirs:     app
    other-modules:
        FormatHeuristic
        Data.OpenApi.Compare.Options

    default-language:   Haskell2010
    default-extensions:
        ApplicativeDo BangPatterns ConstraintKinds DataKinds DeriveAnyClass
        DeriveFoldable DeriveFunctor DeriveGeneric DeriveTraversable
        DerivingStrategies DerivingVia DuplicateRecordFields
        EmptyDataDeriving FlexibleContexts FlexibleInstances
        FunctionalDependencies GADTs GeneralizedNewtypeDeriving LambdaCase
        MultiParamTypeClasses MultiWayIf NamedFieldPuns NumDecimals
        OverloadedStrings PatternSynonyms PolyKinds QuasiQuotes RankNTypes
        RecordWildCards ScopedTypeVariables StandaloneDeriving
        TemplateHaskell TupleSections TypeApplications TypeFamilies
        TypeOperators UndecidableInstances ViewPatterns
        QuantifiedConstraints DefaultSignatures

    ghc-options:
        -Weverything -Wno-implicit-prelude -Wno-missing-safe-haskell-mode
        -Wno-safe -Wno-prepositive-qualified-module
        -Wno-missing-import-lists -Wno-partial-fields
        -Wno-all-missed-specialisations -Wno-missing-local-signatures
        -Wno-unsafe -fconstraint-solver-iterations=0 -threaded -rtsopts
        -with-rtsopts=-N

    build-depends:
        base >=4.12.0.0 && <4.16,
        text >=1.2.4.1 && <1.3,
        compaREST -any,
        pandoc >=2.14.0.3 && <2.15,
        data-default >=0.7.1.1 && <0.8,
        bytestring >=0.10.12.0 && <0.11,
        yaml >=0.11.8.0 && <0.12,
        filepath >=1.4.2.1 && <1.5,
        optparse-applicative >=0.16.1.0 && <0.17,
        mtl >=2.2.2 && <2.3,
        aeson >=1.5.6.0 && <1.6,
        containers >=0.6.5.1 && <0.7,
        doctemplates ==0.9.*,
        pandoc-types >=1.22.1 && <1.23

executable compaREST-GitHub-Action
    main-is:            Main.hs
    hs-source-dirs:     github-action
    other-modules:
        Control.Monad.Freer.GitHub
        CompaREST.GitHub.API
        CompaREST.GitHub.Action.Config
        GitHub.Data.Checks
        GitHub.Endpoints.Checks

    default-language:   Haskell2010
    default-extensions:
        ApplicativeDo BangPatterns ConstraintKinds DataKinds DeriveAnyClass
        DeriveFoldable DeriveFunctor DeriveGeneric DeriveTraversable
        DerivingStrategies DerivingVia DuplicateRecordFields
        EmptyDataDeriving FlexibleContexts FlexibleInstances
        FunctionalDependencies GADTs GeneralizedNewtypeDeriving LambdaCase
        MultiParamTypeClasses MultiWayIf NamedFieldPuns NumDecimals
        OverloadedStrings PatternSynonyms PolyKinds QuasiQuotes RankNTypes
        RecordWildCards ScopedTypeVariables StandaloneDeriving
        TemplateHaskell TupleSections TypeApplications TypeFamilies
        TypeOperators UndecidableInstances ViewPatterns
        QuantifiedConstraints DefaultSignatures

    ghc-options:
        -Weverything -Wno-implicit-prelude -Wno-missing-safe-haskell-mode
        -Wno-safe -Wno-prepositive-qualified-module
        -Wno-missing-import-lists -Wno-partial-fields
        -Wno-all-missed-specialisations -Wno-missing-local-signatures
        -Wno-unsafe -fconstraint-solver-iterations=0 -threaded -rtsopts
        -with-rtsopts=-N

    build-depends:
        base >=4.12.0.0 && <4.16,
        text >=1.2.4.1 && <1.3,
        compaREST -any,
        pandoc >=2.14.0.3 && <2.15,
        yaml >=0.11.8.0 && <0.12,
        aeson >=1.5.6.0 && <1.6,
        github ==0.26.*,
        freer-simple >=1.2.1.2 && <1.3,
        vector >=0.12.3.1 && <0.13,
        pandoc-types >=1.22.1 && <1.23,
        envy >=2.1.0.0 && <2.2,
        filepath >=1.4.2.1 && <1.5,
        bytestring >=0.10.12.0 && <0.11

test-suite compaREST-tests
    type:               exitcode-stdio-1.0
    main-is:            Spec.hs
    hs-source-dirs:     test
    other-modules:
        Spec.Golden.Extra
        Spec.Golden.TraceTree
        Paths_compaREST

    autogen-modules:    Paths_compaREST
    default-language:   Haskell2010
    default-extensions:
        ApplicativeDo BangPatterns ConstraintKinds DataKinds DeriveAnyClass
        DeriveFoldable DeriveFunctor DeriveGeneric DeriveTraversable
        DerivingStrategies DerivingVia DuplicateRecordFields
        EmptyDataDeriving FlexibleContexts FlexibleInstances
        FunctionalDependencies GADTs GeneralizedNewtypeDeriving LambdaCase
        MultiParamTypeClasses MultiWayIf NamedFieldPuns NumDecimals
        OverloadedStrings PatternSynonyms PolyKinds QuasiQuotes RankNTypes
        RecordWildCards ScopedTypeVariables StandaloneDeriving
        TemplateHaskell TupleSections TypeApplications TypeFamilies
        TypeOperators UndecidableInstances ViewPatterns
        QuantifiedConstraints DefaultSignatures

    ghc-options:
        -Weverything -Wno-implicit-prelude -Wno-missing-safe-haskell-mode
        -Wno-safe -Wno-prepositive-qualified-module
        -Wno-missing-import-lists -Wno-partial-fields
        -Wno-all-missed-specialisations -Wno-missing-local-signatures
        -Wno-unsafe -fconstraint-solver-iterations=0 -threaded -rtsopts
        -with-rtsopts=-N

    build-depends:
        base >=4.12.0.0 && <4.16,
        text >=1.2.4.1 && <1.3,
        compaREST -any,
        tasty-golden >=2.3.5 && <2.4,
        tasty >=1.4.2.1 && <1.5,
        bytestring >=0.10.12.0 && <0.11,
        yaml >=0.11.8.0 && <0.12,
        directory >=1.3.6.0 && <1.4,
        filepath >=1.4.2.1 && <1.5,
        pandoc >=2.14.0.3 && <2.15,
        data-default >=0.7.1.1 && <0.8,
        lens >=4.19.2 && <4.20,
        pandoc-types >=1.22.1 && <1.23
