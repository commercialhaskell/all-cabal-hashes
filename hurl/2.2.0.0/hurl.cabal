-- Initial hurl.cabal generated by cabal init.  For further documentation, 
-- see http://haskell.org/cabal/users-guide/

-- The name of the package.
name:                hurl

-- The package version.  See the Haskell package versioning policy (PVP) 
-- for standards guiding when and how versions should be incremented.
-- https://wiki.haskell.org/Package_versioning_policy
-- PVP summary:      +-+------- breaking API changes
--                   | | +----- non-breaking API additions
--                   | | | +--- code changes with no API change
version:             2.2.0.0

-- A short (one-line) description of the package.
synopsis:            Haskell URL resolver

-- A longer description of the package.
description:         Retrieves resources for a URI, whether they be HTTP(S), gemini:, file:, or data:.

-- URL for the project homepage or repository.
homepage:            https://git.adrian.geek.nz/hurl.git/

-- The license under which the package is released.
license:             GPL-3

-- The file containing the license text.
license-file:        LICENSE

-- The package author(s).
author:              Adrian Cochrane

-- An email address to which users can send suggestions, bug reports, and 
-- patches.
maintainer:          adrian@openwork.nz

-- A copyright notice.
-- copyright:           

category:            Network

build-type:          Simple

-- Extra files to be distributed with the package, such as examples or a 
-- README.
extra-source-files:  ChangeLog.md

-- Constraint on the version of Cabal needed to build this package.
cabal-version:       >=1.10

Flag http
  Description: Support HTTP(S) URIs.
  Default:     True
  Manual:      True

Flag gemini
  Description: Support gemini: URIs.
  Default:     True
  Manual:      True

Flag file
  Description: Support file: URIs.
  Default:     True
  Manual:      True

Flag data
  Description: Support data: URIs.
  Default:     True
  Manual:      True

Flag freedesktop
  Description: Dispatches unsupported URIs and MIMEtypes to external apps on FreeDesktop.Org-compatible desktops. Works on most non-mainstream/non-proprietary desktops.
  Default:     True
  Manual:      True

Flag rewriters
  Description:  Support regexp-based URI rewriting/blocking plugins
  Default:		True
  Manual: 		True

Flag executables
  Description:  Support executable plugins exposing a `ext:` URI scheme.
  Default:      True
  Manual:       True

source-repository head
    type: git
    location: https://git.adrian.geek.nz/hurl.git

library
  -- Modules exported by the library.
  exposed-modules:     Network.URI.Charset, Network.URI.Fetch, Network.MIME.Info
  
  -- Modules included in this library but not exported.
  other-modules:       Network.URI.Locale, Network.URI.Messages, Network.URI.Types
  
  -- LANGUAGE extensions used by modules in this package.
  -- other-extensions:    
  
  -- Other library packages from which modules are imported.
  build-depends:       base >=4.9 && <5, text >= 1.2 && <1.3,
                       network-uri >=2.6 && <2.7, bytestring >= 0.10 && < 0.11,
                       async >= 2.1 && < 2.3, filepath, directory >= 1.3.2,
                       time >= 1.6
  
  -- Directories containing source files.
  hs-source-dirs:      src

  ghc-options: -fwarn-incomplete-patterns -fwarn-incomplete-uni-patterns
  
  -- Base language which the package is written in.
  default-language:    Haskell2010
  
  if flag(http)
    CPP-options:   -DWITH_HTTP_URI
    build-depends: http-client, http-types >= 0.12 && <0.13, publicsuffixlist >= 0.1,
                   http-client-tls, time, cookie, connection, tls, data-default-class
    other-modules: Network.URI.Cache, Network.URI.CookiesDB
  if flag(gemini)
    CPP-options:   -DWITH_GEMINI_URI -DWITH_RAW_CONNECTIONS
    build-depends: connection, tls, data-default-class
  if flag(file)
    CPP-options:   -DWITH_FILE_URI
  if flag(data)
    CPP-options:   -DWITH_DATA_URI
    build-depends: base64-bytestring >=1.0 && <2.0
  if flag(freedesktop)
    CPP-options:   -DWITH_XDG
    build-depends: xml-conduit >=1.8, zlib >= 0.6 && < 0.7, containers
    other-modules: Network.URI.XDG.Ini, Network.URI.XDG.MimeApps,
        Network.URI.XDG.DesktopEntry, Network.URI.XDG.MimeInfo, Network.URI.XDG,
        Network.URI.XDG.AppStream, Network.URI.XDG.AppStreamOutput
  if flag(rewriters)
    CPP-options:   -DWITH_PLUGIN_REWRITES
    build-depends: regex, regex-tdfa >= 1.2 && < 1.4
    other-modules: Network.URI.PlugIns.Rewriters
  if flag(executables)
    CPP-options:   -DWITH_PLUGIN_EXEC
    build-depends: process >= 1.2 && <2.0

executable hurl
  -- .hs file containing the Main module
  main-is:             Main.hs

  -- Other library packages from which modules are imported
  build-depends:       base >=4.9 && <5, hurl, network-uri, directory

  -- Directories containing source files.
  hs-source-dirs:      .

  -- Base language which the package is written in.
  default-language:    Haskell2010

  ghc-options: -threaded

executable hurl-post
  -- .hs file containing the Main module
  main-is:              Main2.hs

  -- Other library packages from which modules are imported
  build-depends:        base >= 4.9 && <5, hurl, network-uri, directory, bytestring

  -- Directories containing source files.
  hs-source-dirs:       .

  -- Base languages which the package is written in.
  default-language:     Haskell2010

  ghc-options:          -threaded
